"use strict";(self.webpackChunk_berviantoleo_react_multi_crop=self.webpackChunk_berviantoleo_react_multi_crop||[]).push([[868],{"./src/ReactMultiCrop/ReactMultiCrop.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{DefaultEditable:()=>DefaultEditable,DefaultReadOnly:()=>DefaultReadOnly,__namedExportsOrder:()=>__namedExportsOrder,default:()=>ReactMultiCrop_stories});var external_STORYBOOK_MODULE_TEST_=__webpack_require__("storybook/test"),esm_typeof=__webpack_require__("../../node_modules/@babel/runtime/helpers/esm/typeof.js"),classCallCheck=__webpack_require__("../../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),createClass=__webpack_require__("../../node_modules/@babel/runtime/helpers/esm/createClass.js"),possibleConstructorReturn=__webpack_require__("../../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),getPrototypeOf=__webpack_require__("../../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),inherits=__webpack_require__("../../node_modules/@babel/runtime/helpers/esm/inherits.js"),defineProperty=__webpack_require__("../../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),react=__webpack_require__("../../node_modules/react/index.js"),index_min=__webpack_require__("../../node_modules/fabric/dist/index.min.mjs"),v4=__webpack_require__("../../node_modules/uuid/dist/v4.js");function Container(_ref){var children=_ref.children,height=_ref.height,width=_ref.width,_ref$row=_ref.row,row=void 0!==_ref$row&&_ref$row;return react.createElement("div",{style:{display:"flex",flexDirection:row?"row":"column",gap:"10px",height,width}},children)}function _createForOfIteratorHelper(r,e){var t="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}(r))||e&&r&&"number"==typeof r.length){t&&(r=t);var _n=0,F=function F(){};return{s:F,n:function n(){return _n>=r.length?{done:!0}:{done:!1,value:r[_n++]}},e:function e(r){throw r},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function s(){t=t.call(r)},n:function n(){var r=t.next();return a=r.done,r},e:function e(r){u=!0,o=r},f:function f(){try{a||null==t.return||t.return()}finally{if(u)throw o}}}}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(_isNativeReflectConstruct=function _isNativeReflectConstruct(){return!!t})()}Container.__docgenInfo={description:"",methods:[],displayName:"Container",props:{children:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},height:{required:!1,tsType:{name:"number"},description:""},width:{required:!1,tsType:{name:"number"},description:""},row:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}}}};var ReactMultiCrop=function(_Component){function ReactMultiCrop(props){var _this;return(0,classCallCheck.A)(this,ReactMultiCrop),_this=function _callSuper(t,o,e){return o=(0,getPrototypeOf.A)(o),(0,possibleConstructorReturn.A)(t,_isNativeReflectConstruct()?Reflect.construct(o,e||[],(0,getPrototypeOf.A)(t).constructor):o.apply(t,e))}(this,ReactMultiCrop,[props]),(0,defineProperty.A)(_this,"REGEXP_ORIGINS",/^(\w+:)\/\/([^:/?#]*):?(\d*)/i),_this.state={canvas:null,initial:!0},_this.keyboardHandler=_this.keyboardHandler.bind(_this),_this.addNew=_this.addNew.bind(_this),_this.deleteShapes=_this.deleteShapes.bind(_this),_this.discardActiveObject=_this.discardActiveObject.bind(_this),_this}return(0,inherits.A)(ReactMultiCrop,_Component),(0,createClass.A)(ReactMultiCrop,[{key:"componentDidMount",value:function componentDidMount(){this.state.canvas||this.initialCanvas()}},{key:"componentDidUpdate",value:function componentDidUpdate(prevProps){var canvas=this.state.canvas;if(canvas){var _this$props=this.props,zoomLevel=_this$props.zoomLevel,activeObject=_this$props.activeObject,height=_this$props.height,width=_this$props.width,borderColor=_this$props.borderColor,cornerColor=_this$props.cornerColor,cornerSize=_this$props.cornerSize,transparentCorners=_this$props.transparentCorners,cropBackgroundColor=_this$props.cropBackgroundColor,cropBackgroundOpacity=_this$props.cropBackgroundOpacity,record=_this$props.record,_this$props$disableZo=_this$props.disableZoom,disableZoom=void 0!==_this$props$disableZo&&_this$props$disableZo,prevZoomLevel=prevProps.zoomLevel,prevActive=prevProps.activeObject,prevHeight=prevProps.height,prevWidth=prevProps.width,prevBorderColor=prevProps.borderColor,prevCornerColor=prevProps.cornerColor,prevCornerSize=prevProps.cornerSize,prevTransparentCorners=prevProps.transparentCorners,prevCropBackgroundColor=prevProps.cropBackgroundColor,prevCropBackgroundOpacity=prevProps.cropBackgroundOpacity,prevRecord=prevProps.record,shouldRender=!1;if(prevZoomLevel!==zoomLevel&&zoomLevel&&zoomLevel>0&&(canvas.setZoom(zoomLevel),shouldRender=!0),prevActive!==activeObject&&activeObject){var allSelected=canvas.getObjects().filter(function(obj){return obj.objectId===activeObject});canvas.discardActiveObject();var _step,_iterator=_createForOfIteratorHelper(allSelected);try{for(_iterator.s();!(_step=_iterator.n()).done;){var objectSelect=_step.value;canvas.setActiveObject(objectSelect)}}catch(err){_iterator.e(err)}finally{_iterator.f()}shouldRender=!0}if(canvas.off("mouse:wheel"),!disableZoom){var zoomHandler=this.zoom.bind(this);canvas.on("mouse:wheel",zoomHandler)}if(height&&height!==prevHeight&&(canvas.height=height,shouldRender=!0),width&&width!==prevWidth&&(canvas.width=width,shouldRender=!0),borderColor!==prevBorderColor||cornerColor!==prevCornerColor||cornerSize!==prevCornerSize||transparentCorners!==prevTransparentCorners||cropBackgroundColor!==prevCropBackgroundColor||cropBackgroundOpacity!==prevCropBackgroundOpacity){var attribute={borderColor,cornerColor,cornerSize,transparentCorners,cropBackgroundColor,cropBackgroundOpacity};this.updateCropAttributes(canvas,attribute),shouldRender=!0}var previousRecord=prevRecord;if(Array.isArray(previousRecord.clippings)&&record&&Array.isArray(null==record?void 0:record.clippings)){var differentObjects=record.clippings.filter(function(clip){var _clip$style,_prevClip$style,_clip$style2,_prevClip$style2,_clip$style3,_prevClip$style3,_clip$style4,_prevClip$style4,_clip$style5,_prevClip$style5,_clip$style6,_prevClip$style6,prevClip=previousRecord.clippings.find(function(prev){return prev.id===clip.id||prev.objectId&&prev.objectId===clip.objectId});return!!prevClip&&((null===(_clip$style=clip.style)||void 0===_clip$style?void 0:_clip$style.borderColor)!==(null===(_prevClip$style=prevClip.style)||void 0===_prevClip$style?void 0:_prevClip$style.borderColor)||(null===(_clip$style2=clip.style)||void 0===_clip$style2?void 0:_clip$style2.cornerColor)!==(null===(_prevClip$style2=prevClip.style)||void 0===_prevClip$style2?void 0:_prevClip$style2.cornerColor)||(null===(_clip$style3=clip.style)||void 0===_clip$style3?void 0:_clip$style3.cornerSize)!==(null===(_prevClip$style3=prevClip.style)||void 0===_prevClip$style3?void 0:_prevClip$style3.cornerSize)||(null===(_clip$style4=clip.style)||void 0===_clip$style4?void 0:_clip$style4.transparentCorners)!==(null===(_prevClip$style4=prevClip.style)||void 0===_prevClip$style4?void 0:_prevClip$style4.transparentCorners)||(null===(_clip$style5=clip.style)||void 0===_clip$style5?void 0:_clip$style5.cropBackgroundColor)!==(null===(_prevClip$style5=prevClip.style)||void 0===_prevClip$style5?void 0:_prevClip$style5.cropBackgroundColor)||(null===(_clip$style6=clip.style)||void 0===_clip$style6?void 0:_clip$style6.cropBackgroundOpacity)!==(null===(_prevClip$style6=prevClip.style)||void 0===_prevClip$style6?void 0:_prevClip$style6.cropBackgroundOpacity))}),canvasObjects=canvas.getObjects("rect");if(Array.isArray(canvasObjects)&&canvasObjects.length>0){var affectedObj=0;differentObjects.forEach(function(difObj){var _difObj$style,_difObj$style2,_difObj$style3,_difObj$style4,_difObj$style5,_difObj$style6,affectedObject=canvasObjects.find(function(obj){return obj.id===difObj.id||obj.objectId===difObj.objectId});affectedObject&&(affectedObject.borderColor=(null===(_difObj$style=difObj.style)||void 0===_difObj$style?void 0:_difObj$style.borderColor)||"",affectedObject.cornerColor=(null===(_difObj$style2=difObj.style)||void 0===_difObj$style2?void 0:_difObj$style2.cornerColor)||"",affectedObject.cornerSize=(null===(_difObj$style3=difObj.style)||void 0===_difObj$style3?void 0:_difObj$style3.cornerSize)||0,affectedObject.transparentCorners=(null===(_difObj$style4=difObj.style)||void 0===_difObj$style4?void 0:_difObj$style4.transparentCorners)||!1,affectedObject.opacity=(null===(_difObj$style5=difObj.style)||void 0===_difObj$style5?void 0:_difObj$style5.cropBackgroundOpacity)||1,affectedObject.set("fill",null===(_difObj$style6=difObj.style)||void 0===_difObj$style6?void 0:_difObj$style6.cropBackgroundColor),affectedObj+=1)}),affectedObj>0&&(shouldRender=!0)}}shouldRender&&canvas.requestRenderAll()}}},{key:"updateCropAttributes",value:function updateCropAttributes(canvas,attribute){var objects=canvas.getObjects("rect");Array.isArray(objects)&&objects.length>0&&objects.forEach(function(object){object.borderColor=attribute.borderColor||"",object.cornerColor=attribute.cornerColor||"",object.cornerSize=attribute.cornerSize||0,object.transparentCorners=attribute.transparentCorners||!1,object.opacity=attribute.cropBackgroundOpacity||1,object.set("fill",attribute.cropBackgroundColor)})}},{key:"changeImage",value:function changeImage(){var canvas=this.state.canvas;canvas&&(canvas.backgroundImage||this.initialImage())}},{key:"loadImage",value:function loadImage(img){var _this$state=this.state,initial=_this$state.initial,canvas=_this$state.canvas;if(canvas&&canvas.width&&canvas.height&&img.height&&img.width){var zoomLevel=this.props.zoomLevel,ratio=img.height/img.width,newHeight=canvas.width*ratio;canvas.height=newHeight,zoomLevel?canvas.setZoom(zoomLevel):canvas.setZoom(canvas.width/img.width),canvas.backgroundImage=img,initial&&this.setState({initial:!1},this.initialObjects.bind(this))}}},{key:"isCrossOriginURL",value:function isCrossOriginURL(url){var parts=url.match(this.REGEXP_ORIGINS);return null!==parts&&(parts[1]!==window.location.protocol||parts[2]!==window.location.hostname||parts[3]!==window.location.port)}},{key:"initialImage",value:function initialImage(){var image=this.props.image,loadImageNow=this.loadImage.bind(this);if("string"==typeof image){var options={};this.isCrossOriginURL(image)&&(options.crossOrigin="Anonymous"),index_min.Ng.fromURL(image,options).then(function(result){loadImageNow(result)})}}},{key:"initialObjects",value:function initialObjects(){var canvas=this.state.canvas;if(canvas){var _this$props2=this.props,record=_this$props2.record,readonly=_this$props2.readonly,borderColor=_this$props2.borderColor,cornerColor=_this$props2.cornerColor,cornerSize=_this$props2.cornerSize,transparentCorners=_this$props2.transparentCorners,cropBackgroundColor=_this$props2.cropBackgroundColor,cropBackgroundOpacity=_this$props2.cropBackgroundOpacity;if(record){var inputObject=record.clippings;if(Array.isArray(inputObject)&&inputObject.length>0&&"object"===(0,esm_typeof.A)(inputObject[0])){var _step2,attribute={borderColor,cornerColor,cornerSize,transparentCorners,cropBackgroundColor,cropBackgroundOpacity},totalRendered=0,_iterator2=_createForOfIteratorHelper(inputObject);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var coord=_step2.value;coord.style&&(coord.style.cropBackgroundColor&&(attribute.cropBackgroundColor=coord.style.cropBackgroundColor),coord.style.cropBackgroundOpacity&&(attribute.cropBackgroundOpacity=coord.style.cropBackgroundOpacity),coord.style.borderColor&&(attribute.borderColor=coord.style.borderColor),coord.style.cornerColor&&(attribute.cornerColor=coord.style.cornerColor),coord.style.cornerSize&&(attribute.cornerSize=coord.style.cornerSize),coord.style.transparentCorners&&(attribute.transparentCorners=coord.style.transparentCorners));var rect=this.createObject(canvas,coord,attribute,readonly||!1);rect&&(canvas.add(rect),totalRendered+=1)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}totalRendered>0&&this.setOutput()}}else console.log("Not have any record. Skipped.")}}},{key:"zoom",value:function zoom(options){var canvas=this.state.canvas;if(canvas){var delta=options.e.deltaY,zoom=canvas.getZoom();zoom*=Math.pow(.999,delta),zoom>20&&(zoom=20),zoom<.01&&(zoom=.01),canvas.setZoom(zoom),options.e.preventDefault(),options.e.stopPropagation();var zoomChanged=this.props.zoomChanged;zoomChanged&&zoomChanged(zoom)}}},{key:"mouseHover",value:function mouseHover(options){var onHover=this.props.onHover,converter=this.shapetoStructureData.bind(this),target=options.target;target&&"rect"===target.type&&onHover&&onHover(converter(target))}},{key:"mouseOut",value:function mouseOut(options){var onHover=this.props.onHover,target=options.target;target&&"rect"===target.type&&onHover&&onHover(null)}},{key:"selectionHandler",value:function selectionHandler(options){var onSelect=this.props.onSelect,converter=this.shapetoStructureData.bind(this),selectedList=options.selected;if(Array.isArray(selectedList)&&0!=selectedList.length){var target=selectedList[0];if(target&&"rect"===target.type&&onSelect)onSelect(converter(target))}}},{key:"selectionClearHandler",value:function selectionClearHandler(){var onSelect=this.props.onSelect;onSelect&&onSelect(null)}},{key:"initialCanvas",value:function initialCanvas(){var _this$props3=this.props,id=_this$props3.id,width=_this$props3.width,height=_this$props3.height,readonly=_this$props3.readonly,canvas=new index_min.Hl(id||"canvas",{width,height});if(readonly){canvas.selectionKey=void 0;var mouseHoverHandler=this.mouseHover.bind(this),mouseHoverOutHandler=this.mouseOut.bind(this);canvas.on("mouse:over",mouseHoverHandler),canvas.on("mouse:out",mouseHoverOutHandler)}else{var doubleClickEvent=this.doubleClickEvent.bind(this),objectModifiedEvent=this.setOutput.bind(this);canvas.on("mouse:dblclick",doubleClickEvent),canvas.on("object:modified",objectModifiedEvent)}var selectionObjectHandler=this.selectionHandler.bind(this),selectionObjectClearHandler=this.selectionClearHandler.bind(this);canvas.on("selection:created",selectionObjectHandler),canvas.on("selection:updated",selectionObjectHandler),canvas.on("selection:cleared",selectionObjectClearHandler),canvas.on("mouse:down",function(opt){var evt=opt.e;!0===evt.altKey&&(this.isDragging=!0,this.selection=!1,this.lastPosX=evt.clientX,this.lastPosY=evt.clientY)}),canvas.on("mouse:move",function(opt){if(this.isDragging){var e=opt.e,vpt=this.viewportTransform;vpt[4]+=e.clientX-this.lastPosX,vpt[5]+=e.clientY-this.lastPosY,this.requestRenderAll(),this.lastPosX=e.clientX,this.lastPosY=e.clientY}}),canvas.on("mouse:up",function(){this.setViewportTransform(this.viewportTransform),this.isDragging=!1,this.selection=!0}),this.setState({canvas},this.initialImage.bind(this))}},{key:"addNew",value:function addNew(){var canvas=this.state.canvas;if(canvas){var _this$props4=this.props,attribute={borderColor:_this$props4.borderColor,cornerColor:_this$props4.cornerColor,cornerSize:_this$props4.cornerSize,transparentCorners:_this$props4.transparentCorners,cropBackgroundColor:_this$props4.cropBackgroundColor,cropBackgroundOpacity:_this$props4.cropBackgroundOpacity},rect=this.createObject(canvas,{id:null,rect:{x1:0,y1:0,x2:.2,y2:.2}},attribute,!1);rect&&(canvas.add(rect),this.setOutput())}}},{key:"doubleClickEvent",value:function doubleClickEvent(options){var canvas=this.state.canvas;if(canvas){var _this$props5=this.props,readonly=_this$props5.readonly,borderColor=_this$props5.borderColor,cornerColor=_this$props5.cornerColor,cornerSize=_this$props5.cornerSize,transparentCorners=_this$props5.transparentCorners,cropBackgroundColor=_this$props5.cropBackgroundColor,cropBackgroundOpacity=_this$props5.cropBackgroundOpacity;if(options&&options.target){var left=options.target.left,top=options.target.top,width=options.target.width,height=options.target.height,attribute={left:left+50,top:top+50,width:width*options.target.scaleX,height:height*options.target.scaleY,borderColor,cornerColor,cornerSize,transparentCorners,cropBackgroundColor,cropBackgroundOpacity},rect=this.createObjectByAttribute(null,attribute,readonly||!1);canvas.add(rect),canvas.discardActiveObject(),canvas.setActiveObject(rect),canvas.requestRenderAll(),this.setOutput()}else if(options&&options.pointer){var _attribute={left:options.absolutePointer.x,top:options.absolutePointer.y,width:100,height:100,borderColor,cornerColor,cornerSize,transparentCorners,cropBackgroundColor,cropBackgroundOpacity},_rect=this.createObjectByAttribute(null,_attribute,readonly||!1);canvas.add(_rect),canvas.discardActiveObject(),canvas.setActiveObject(_rect),canvas.requestRenderAll(),this.setOutput()}}}},{key:"createObjectByAttribute",value:function createObjectByAttribute(existingId,attribute,readonly){var rect=new index_min.rw({left:attribute.left,top:attribute.top,width:attribute.width,height:attribute.height,borderColor:attribute.borderColor,cornerColor:attribute.cornerColor,cornerSize:attribute.cornerSize,transparentCorners:attribute.transparentCorners,fill:attribute.cropBackgroundColor,opacity:attribute.cropBackgroundOpacity,id:existingId,strokeWidth:0,strokeUniform:!0,lockRotation:!0,lockMovementX:readonly,lockMovementY:readonly,lockScalingX:readonly,lockScalingY:readonly,objectId:(0,v4.A)()});return rect.setControlsVisibility({mtr:!1}),rect}},{key:"convertLeftTop",value:function convertLeftTop(element){var _element$group,_element$group2,_element$group3,_element$group4;return void 0===element.left||void 0===element.top||void 0===(null===(_element$group=element.group)||void 0===_element$group?void 0:_element$group.left)||void 0===(null===(_element$group2=element.group)||void 0===_element$group2?void 0:_element$group2.top)||void 0===(null===(_element$group3=element.group)||void 0===_element$group3?void 0:_element$group3.width)||void 0===(null===(_element$group4=element.group)||void 0===_element$group4?void 0:_element$group4.height)?{left:0,top:0}:{left:element.left+element.group.left+element.group.width/2,top:element.top+element.group.top+element.group.height/2}}},{key:"shapetoStructureData",value:function shapetoStructureData(element){var canvas=this.state.canvas;if(!canvas||!canvas.backgroundImage)return null;var background=canvas.backgroundImage;if(!(background instanceof index_min.Ng))return null;if(void 0===element.left||void 0===element.top||void 0===element.width||void 0===element.height||void 0===element.scaleX||void 0===element.scaleY||void 0===background.width||void 0===background.height)return null;var _this$props6=this.props,includeDataUrl=_this$props6.includeDataUrl,includeHtmlCanvas=_this$props6.includeHtmlCanvas,dataLeftTop=element.group?this.convertLeftTop(element):{left:element.left,top:element.top},x1=dataLeftTop.left/background.width,y1=dataLeftTop.top/background.height,x2=(dataLeftTop.left+element.width*element.scaleX)/background.width,y2=(dataLeftTop.top+element.height*element.scaleY)/background.height,rectangle={x1,y1,x2,y2},coord={id:element.id,objectId:element.objectId,rect:JSON.stringify(rectangle)};if(includeDataUrl){var dataUrl=null;try{dataUrl=background.toDataURL({height:element.getScaledHeight(),width:element.getScaledWidth(),left:dataLeftTop.left,top:dataLeftTop.top,format:"jpeg"})}catch(error){console.error(error)}coord.dataUrl=dataUrl}if(includeHtmlCanvas){var canvasElement=null;try{canvasElement=background.toCanvasElement({height:element.getScaledHeight(),width:element.getScaledWidth(),left:dataLeftTop.left,top:dataLeftTop.top})}catch(error){console.error(error)}coord.canvasElement=canvasElement}var imgWidth=background.width,imgHeight=background.height,x1Px=x1*imgWidth,x2Px=x2*imgWidth,y1Px=y1*imgHeight,y2Px=y2*imgHeight,rectanglePx={x:x1Px,y:y1Px,x2:x2Px,y2:y2Px,w:x2Px-x1Px,h:y2Px-y1Px,boundX:imgWidth,boundY:imgHeight};return coord.crop=JSON.stringify(rectanglePx),coord.deletedAt="-1",coord}},{key:"deleteShapes",value:function deleteShapes(){var readonly=this.props.readonly,canvas=this.state.canvas;canvas&&!readonly&&(canvas.getActiveObjects().forEach(function(element){canvas.remove(element)}),this.setOutput())}},{key:"setOutput",value:function setOutput(){var canvas=this.state.canvas;if(canvas){var shapeToStructureData=this.shapetoStructureData.bind(this),outputValue=[];canvas.getObjects("rect").forEach(function(element){var outputData=shapeToStructureData(element);outputData&&outputValue.push(outputData)});var input=this.props.input;input&&input.onChange(outputValue)}}},{key:"createObject",value:function createObject(canvas,coor,attribute,readonly){if(!canvas||!canvas.backgroundImage)return null;var rectangle,background=canvas.backgroundImage;if(!(background instanceof index_min.Ng))return null;if(!background.width||!background.height)return null;rectangle="string"==typeof coor.rect?JSON.parse(coor.rect):coor.rect;var left=background.width*rectangle.x1,top=background.height*rectangle.y1,newAttribute={left,top,width:background.width*rectangle.x2-left,height:background.height*rectangle.y2-top,borderColor:attribute.borderColor,cornerColor:attribute.cornerColor,cornerSize:attribute.cornerSize,transparentCorners:attribute.transparentCorners,cropBackgroundColor:attribute.cropBackgroundColor,cropBackgroundOpacity:attribute.cropBackgroundOpacity};return this.createObjectByAttribute(coor.id,newAttribute,readonly)}},{key:"discardActiveObject",value:function discardActiveObject(){var canvas=this.state.canvas;canvas?(canvas.discardActiveObject(),canvas.requestRenderAll()):console.log("Canvas not defined")}},{key:"keyboardHandler",value:function keyboardHandler(event){if(!event.defaultPrevented){var handled=!1,key=event.key||event.keyCode;"Delete"!==key&&46!==key||(this.deleteShapes(),handled=!0),handled&&event.preventDefault()}}},{key:"render",value:function render(){var _this$props7=this.props,height=_this$props7.height,id=_this$props7.id,readonly=_this$props7.readonly,style=_this$props7.style,width=_this$props7.width,tabIndex=_this$props7.tabIndex;return react.createElement("div",{id:"canvas-wrapper",style},react.createElement(Container,{row:!0,width,height},react.createElement("div",{onKeyDown:readonly?void 0:this.keyboardHandler,tabIndex:null!=tabIndex?tabIndex:0},react.createElement("canvas",{id,height,style:{border:"0px solid #aaa"},width}))))}}])}(react.Component);(0,defineProperty.A)(ReactMultiCrop,"defaultProps",{borderColor:"black",cornerColor:"black",cornerSize:13,cropBackgroundColor:"yellow",cropBackgroundOpacity:.5,disableZoom:!1,height:800,id:"canvas",image:void 0,includeDataUrl:!1,includeHtmlCanvas:!1,input:void 0,readonly:!1,record:{clippings:[]},transparentCorners:!0,width:800,zoomChanged:void 0});const ReactMultiCrop_ReactMultiCrop=ReactMultiCrop;ReactMultiCrop.__docgenInfo={description:"",methods:[{name:"updateCropAttributes",docblock:null,modifiers:[],params:[{name:"canvas",optional:!1,type:{name:"Canvas",alias:"Canvas"}},{name:"attribute",optional:!1,type:{name:"IAttribute",alias:"IAttribute"}}],returns:null},{name:"changeImage",docblock:null,modifiers:[],params:[],returns:{type:{name:"void"}}},{name:"loadImage",docblock:null,modifiers:[],params:[{name:"img",optional:!1,type:{name:"FabricImage",alias:"FabricImage"}}],returns:{type:{name:"void"}}},{name:"isCrossOriginURL",docblock:null,modifiers:[],params:[{name:"url",optional:!1,type:{name:"string"}}],returns:{type:{name:"boolean"}}},{name:"initialImage",docblock:null,modifiers:[],params:[],returns:{type:{name:"void"}}},{name:"initialObjects",docblock:null,modifiers:[],params:[],returns:{type:{name:"void"}}},{name:"zoom",docblock:null,modifiers:[],params:[{name:"options",optional:!1,type:{name:"any"}}],returns:{type:{name:"void"}}},{name:"mouseHover",docblock:null,modifiers:[],params:[{name:"options",optional:!1,type:{name:"any"}}],returns:{type:{name:"void"}}},{name:"mouseOut",docblock:null,modifiers:[],params:[{name:"options",optional:!1,type:{name:"any"}}],returns:{type:{name:"void"}}},{name:"selectionHandler",docblock:null,modifiers:[],params:[{name:"options",optional:!1,type:{name:"any"}}],returns:{type:{name:"void"}}},{name:"selectionClearHandler",docblock:null,modifiers:[],params:[],returns:{type:{name:"void"}}},{name:"initialCanvas",docblock:null,modifiers:[],params:[],returns:{type:{name:"void"}}},{name:"addNew",docblock:null,modifiers:[],params:[],returns:{type:{name:"void"}}},{name:"doubleClickEvent",docblock:null,modifiers:[],params:[{name:"options",optional:!1,type:{name:"any"}}],returns:{type:{name:"void"}}},{name:"createObjectByAttribute",docblock:null,modifiers:[],params:[{name:"existingId",optional:!1,type:{name:"union",raw:"string | null",elements:[{name:"string"},{name:"null"}]}},{name:"attribute",optional:!1,type:{name:"IAttribute",alias:"IAttribute"}},{name:"readonly",optional:!1,type:{name:"boolean"}}],returns:{type:{name:"Rect"}}},{name:"shapetoStructureData",docblock:null,modifiers:[],params:[{name:"element",optional:!1,type:{name:"Rect",alias:"Rect"}}],returns:{type:{name:"union",raw:"IOutputData | null",elements:[{name:"IOutputData"},{name:"null"}]}}},{name:"deleteShapes",docblock:null,modifiers:[],params:[],returns:{type:{name:"void"}}},{name:"setOutput",docblock:null,modifiers:[],params:[],returns:{type:{name:"void"}}},{name:"createObject",docblock:null,modifiers:[],params:[{name:"canvas",optional:!1,type:{name:"union",raw:"Canvas | null",elements:[{name:"Canvas"},{name:"null"}]}},{name:"coor",optional:!1,type:{name:"ICoord",alias:"ICoord"}},{name:"attribute",optional:!1,type:{name:"IAttribute",alias:"IAttribute"}},{name:"readonly",optional:!1,type:{name:"boolean"}}],returns:{type:{name:"union",raw:"Rect | null",elements:[{name:"Rect"},{name:"null"}]}}},{name:"discardActiveObject",docblock:null,modifiers:[],params:[],returns:{type:{name:"void"}}},{name:"keyboardHandler",docblock:null,modifiers:[],params:[{name:"event",optional:!1,type:{name:"ReactKeyboardEvent",raw:"React.KeyboardEvent<HTMLDivElement>",elements:[{name:"HTMLDivElement"}],alias:"React.KeyboardEvent"}}],returns:{type:{name:"void"}}}],displayName:"ReactMultiCrop",props:{activeObject:{required:!1,tsType:{name:"string"},description:""},disableZoom:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},id:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"'canvas'",computed:!1}},image:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"undefined",computed:!0}},includeDataUrl:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},includeHtmlCanvas:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},input:{required:!1,tsType:{name:"IInputProps"},description:"",defaultValue:{value:"undefined",computed:!0}},readonly:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},record:{required:!1,tsType:{name:"IRecordProps"},description:"",defaultValue:{value:"{\n  clippings: [],\n}",computed:!1}},height:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"800",computed:!1}},width:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"800",computed:!1}},tabIndex:{required:!1,tsType:{name:"number"},description:""},zoomLevel:{required:!1,tsType:{name:"number"},description:""},borderColor:{required:!1,tsType:{name:"string"},description:"@deprecated use borderColor in record",defaultValue:{value:"'black'",computed:!1}},cornerColor:{required:!1,tsType:{name:"string"},description:"@deprecated use cornerColor in record",defaultValue:{value:"'black'",computed:!1}},cornerSize:{required:!1,tsType:{name:"number"},description:"@deprecated use cornerSize in record",defaultValue:{value:"13",computed:!1}},cropBackgroundColor:{required:!1,tsType:{name:"string"},description:"@deprecated use cropBackgroundColor in record",defaultValue:{value:"'yellow'",computed:!1}},cropBackgroundOpacity:{required:!1,tsType:{name:"number"},description:"@deprecated use cropBackgroundOpacity in record",defaultValue:{value:"0.5",computed:!1}},transparentCorners:{required:!1,tsType:{name:"boolean"},description:"@deprecated use transparentCorners in record",defaultValue:{value:"true",computed:!1}},style:{required:!1,tsType:{name:"ReactCSSProperties",raw:"React.CSSProperties"},description:"@deprecated avoid to use this props"},zoomChanged:{defaultValue:{value:"undefined",computed:!0},required:!1}}};const ReactMultiCrop_stories={component:ReactMultiCrop_ReactMultiCrop,argTypes:{cropBackgroundColor:{options:["yellow","blue","red"],control:{type:"select"}}}},DefaultEditable={args:{id:"defaultEdit",image:"https://picsum.photos/800",readonly:!1,includeDataUrl:!1,includeHtmlCanvas:!1,cropBackgroundColor:"yellow",cropBackgroundOpacity:.3,input:{onChange:(0,external_STORYBOOK_MODULE_TEST_.fn)()}}},DefaultReadOnly={args:{id:"defaultReadonly",image:"https://picsum.photos/800",readonly:!0,includeDataUrl:!1,includeHtmlCanvas:!1,cropBackgroundColor:"yellow",cropBackgroundOpacity:.3,record:{clippings:[{id:"1",rect:{x1:.1,x2:.2,y1:.1,y2:.2}},{id:"2",rect:{x1:.3,x2:.4,y1:.3,y2:.4}},{id:"3",rect:{x1:.8,x2:1,y1:.8,y2:1}}]},input:{onChange:(0,external_STORYBOOK_MODULE_TEST_.fn)()}}},__namedExportsOrder=["DefaultEditable","DefaultReadOnly"]}}]);